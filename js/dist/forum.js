(()=>{var t={n:o=>{var n=o&&o.__esModule?()=>o.default:()=>o;return t.d(n,{a:n}),n},d:(o,n)=>{for(var e in n)t.o(n,e)&&!t.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:n[e]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o)};(()=>{"use strict";const o=flarum.core.compat["common/app"];t.n(o)().initializers.add("xypp/flarum-answer-bounty",(function(){console.log("[xypp/flarum-answer-bounty] Hello, forum and admin!")}));const n=flarum.core.compat["forum/app"];var e=t.n(n);const r=flarum.core.compat["common/extend"],s=flarum.core.compat["common/utils/classList"];var a=t.n(s);const u=flarum.core.compat["forum/components/DiscussionComposer"];var i=t.n(u);function c(t,o){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},c(t,o)}function l(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,c(t,o)}const p=flarum.core.compat["common/components/Modal"];var y=t.n(p);const f=flarum.core.compat["common/components/Button"];var d=t.n(f);const b=flarum.core.compat["common/utils/Stream"];var v=t.n(b),h=function(t){function o(){for(var o,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return(o=t.call.apply(t,[this].concat(e))||this).money=void 0,o}l(o,t);var n=o.prototype;return n.oninit=function(o){t.prototype.oninit.call(this,o),this.money=new(v())(this.attrs.current||0)},n.className=function(){return"Modal Modal--small"},n.title=function(){return e().translator.trans("xypp-answer-bounty.forum.modal.title")},n.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",{for:"xypp-bounty-amount"},e().translator.trans("xypp-answer-bounty.forum.modal.label")),m("input",{id:"xypp-bounty-amount",required:!0,className:"FormControl",type:"number",step:"any",min:"1",bidi:this.money})),m("div",{className:"Form-group"},d().component({className:"Button Button--primary",type:"submit"},e().translator.trans("xypp-answer-bounty.forum.modal.submit")),d().component({className:"Button Button--danger",onclick:function(){t.attrs.onselect(null),e().modal.close()}.bind(this)},e().translator.trans("xypp-answer-bounty.forum.modal.clear")))))},n.onsubmit=function(t){t.preventDefault(),this.attrs.onselect(this.money()),e().modal.close()},o}(y());function x(t){return function(){e().modal.show(h,{current:t.composer.fields.bounty||1,onselect:function(o){o?t.composer.fields.bounty=o:delete t.composer.fields.bounty}})}}const w=flarum.core.compat["forum/utils/DiscussionControls"];var B=t.n(w);const N=flarum.core.compat["forum/components/CommentPost"];var g=t.n(N);const O=flarum.core.compat["common/Component"];var C=t.n(O),_=function(t){function o(){return t.apply(this,arguments)||this}return l(o,t),o.prototype.view=function(t){var o=e().forum.attribute("antoinefr-money.moneyname")||"[money]";return m("div",{className:"BountyTip"},m("i",{class:"fas fa-coins"}),e().translator.trans("xypp-answer-bounty.forum.tip",{money:o.replace("[money]",this.attrs.number+""),span:m("span",{className:"BountyTip-number"})}))},o}(C());const j=flarum.core.compat["common/components/Badge"];var A=t.n(j);const M=flarum.core.compat["common/models/Discussion"];var P=t.n(M),k=function(t){function o(){return t.apply(this,arguments)||this}return l(o,t),o.prototype.view=function(t){var o=e().forum.attribute("antoinefr-money.moneyname")||"[money]";return m("span",{className:"BountyBestAns"},m("i",{class:"fas fa-coins"}),e().translator.trans("xypp-answer-bounty.forum.tip-ans",{money:o.replace("[money]",this.attrs.number+""),span:m("span",{className:"BountyTip-number"})}))},o}(C());e().initializers.add("xypp/flarum-answer-bounty",(function(){var t;t=i(),(0,r.extend)(t.prototype,"headerItems",(function(t){var o,n,r;null==(o=this.composer)||null==(o=o.fields)||!o.tags||!this.composer.fields.tags.find((function(t){return t.attribute("isQnA")}))||t.add("bounty",m("a",{className:"ComposerBody-bounty",onclick:x(this)},m("span",{className:a()("BountyLabel",!this.composer.fields.bounty&&"none")},e().translator.trans("xypp-answer-bounty.forum.composer."+(null!=(n=this.composer)&&null!=(n=n.fields)&&n.bounty?"edit":"set"),{bounty:null==(r=this.composer)||null==(r=r.fields)?void 0:r.bounty}))),1)})),(0,r.extend)(t.prototype,"data",(function(t){var o,n;null!=(o=this.composer)&&null!=(o=o.fields)&&o.bounty&&(t.bounty=null==(n=this.composer)||null==(n=n.fields)?void 0:n.bounty)})),(0,r.extend)(B(),"moderationControls",(function(t,o){var n,r=o.user(),s=null==(n=e().session)?void 0:n.user,a=!1;s&&r&&s.id()!==r.id()?o.attribute("xypp-answer-bounty-moderate")&&(a=!0):o.attribute("xypp-answer-bounty-use")&&(a=!0),a&&t.add("fingerprint-recorder-fingerprint",d().component({icon:"fas fa-users-cog",className:"Button Button--link",onclick:function(){e().modal.show(h,{current:o.attribute("bounty")||1,onselect:function(t){o.save({bounty:t})}})}},e().translator.trans("xypp-answer-bounty.forum.discussion."+(o.attribute("bounty")?"edit":"set"),{bounty:o.attribute("bounty")})))})),(0,r.extend)(g().prototype,"footerItems",(function(t){var o=this.attrs.post,n=o.discussion();!n.hasBestAnswer()&&n.attribute("bounty")&&1===o.number()&&!o.isHidden()&&t.add("bountyTip",m(_,{number:n.attribute("bounty")}),1e5)})),(0,r.extend)(P().prototype,"badges",(function(t){this.attribute("bounty")&&t.add("bounty",A().component({type:"bounty",label:e().translator.trans("xypp-answer-bounty.forum.badge"),icon:"fas fa-coins"}),5)})),(0,r.extend)(flarum.extensions["fof-best-answer"].components.SelectBestAnswerItem.prototype,"items",(function(t){this.discussion.attribute("bounty")&&t.add("bounty",m(k,{number:this.discussion.attribute("bounty")}))}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map